{% extends "admin/base.html" %}

{% block body %}
<!-- BREAD CRUMB -->
<ol class="breadcrumb" style="margin-bottom: 5px;">
  <li><a href="{{p.url}}"><span class="glyphicon glyphicon-home"></span></a></li>
  <li><a href="{{p.url}}?mode=site">Sites</a></li>
  <li><a href="{{p.url}}?mode=nav&amp;site_id={{ p.site_id }}">Manage Navigation</a></li>
  <li><a href="{{p.url}}?mode=role&amp;site_id={{ p.site_id }}&smp;role_id={{ p.role_id }}">Manage Role</a></li>
</ol>
{%if p.message%}<div class="alert alert-danger">{{p.message}}</div>{%endif%}

<div class="row">

  <div class="col-lg-12">
    <br>
    <form method=post action="/admin/edit">
      <input type=hidden name=mode value=role>
      <input type=hidden name=id value="{{ p.role_id }}">
      <input type=hidden name=site_id value='{{ p.site_id }}'>
      <input type=hidden name=role_id value='{{ p.role_id }}'>

      <legend>Manage permission for role - "{{ p.role.name }}" at site - "{{ p.site.display_name }}"</legend>

      {% for nav in p.nav_list %}
      <table class="table table-stripped table-hover table-responsive">
        <thead>
          <tr>
            <th colspan=3>{{ nav.display_name }}</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <input type="checkbox" name="operations" value="0_{{nav.id}}"
                {%- if "0_"+nav.id in p.role.operations %} checked="1" {%endif-%} >
            </td>
            <td>all</td>
            <td>All operation allowed</td>
          </tr>

          {% for o in nav.operations if o != "0_"+nav.id %}
          <tr>
            <td>
              <input type="checkbox" name="operations" value="{{o.id}}_{{nav.id}}"
                {% if o.is_allowed %}checked="1"{%endif%} >
            </td>
            <td>{{o.name}}</td>
            <td>{{o.description}}</td>
          </tr>
          {% endfor %}

        </tbody>
      </table>
      {% endfor %}

      <div class="form-group">
        <div class="col-lg-10 col-lg-offset-2">
          <button type="reset" class="btn btn-default">Cancel</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </div>
    </form>
  </div>

</div>
{% endblock %}
